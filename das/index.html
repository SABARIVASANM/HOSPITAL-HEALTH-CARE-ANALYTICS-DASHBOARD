<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Hospital Patient Flow — Analytics Dashboard</title>
		<link rel="icon" type="image/png" href="logo.png" />
		<style>
			:root {
				--primary: #2563eb;
				--primary-hover: #1d4ed8;
				--primary-light: #3b82f6;
				--success: #10b981;
				--warning: #f59e0b;
				--danger: #ef4444;
				--bg: #0f172a;
				--bg-elevated: #1e293b;
				--fg: #f1f5f9;
				--fg-muted: #94a3b8;
				--border: #334155;
				--border-light: #475569;
				--card: #1e293b;
				--shadow: rgba(0, 0, 0, 0.3);
			}

			:root.light-mode {
				--bg: #f8fafc;
				--bg-elevated: #ffffff;
				--fg: #0f172a;
				--fg-muted: #64748b;
				--border: #e2e8f0;
				--border-light: #cbd5e1;
				--card: #ffffff;
				--shadow: rgba(0, 0, 0, 0.1);
			}

			* {
				box-sizing: border-box;
				margin: 0;
				padding: 0;
			}

			html,
			body {
				height: 100%;
				overflow: hidden;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
					"Helvetica Neue", Arial, sans-serif;
				color: var(--fg);
				background: var(--bg);
				display: flex;
				flex-direction: column;
			}

			/* Top Navigation Bar */
			.top-nav {
				background: var(--bg-elevated);
				border-bottom: 1px solid var(--border);
				padding: 0 24px;
				height: 64px;
				display: flex;
				align-items: center;
				justify-content: space-between;
				box-shadow: 0 2px 8px var(--shadow);
				position: relative;
				z-index: 100;
			}

			.nav-brand {
				display: flex;
				align-items: center;
				gap: 12px;
			}

			.nav-logo {
				width: 48px;
				height: 48px;
				border-radius: 8px;
				display: flex;
				align-items: center;
				justify-content: center;
				object-fit: contain;
			}

			.nav-logo img {
				width: 100%;
				height: 100%;
				border-radius: 8px;
				object-fit: cover;
			}

			.nav-title {
				font-size: 18px;
				font-weight: 600;
				color: var(--fg);
			}

			.nav-subtitle {
				font-size: 13px;
				color: var(--fg-muted);
				font-weight: 400;
			}

			.nav-actions {
				display: flex;
				align-items: center;
				gap: 8px;
			}

			.btn {
				padding: 8px 16px;
				border-radius: 6px;
				border: none;
				font-size: 14px;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s;
				display: inline-flex;
				align-items: center;
				gap: 6px;
			}

			.btn-secondary {
				background: var(--card);
				color: var(--fg);
				border: 1px solid var(--border);
			}

			.btn-secondary:hover {
				background: var(--bg-elevated);
				border-color: var(--border-light);
			}

			.btn-icon {
				width: 36px;
				height: 36px;
				padding: 0;
				display: inline-flex;
				align-items: center;
				justify-content: center;
				border-radius: 6px;
				background: transparent;
				color: var(--fg-muted);
				border: 1px solid transparent;
				cursor: pointer;
				transition: all 0.2s;
			}

			.btn-icon:hover {
				background: var(--card);
				color: var(--fg);
				border-color: var(--border);
			}

			/* Main Layout */
			.main-layout {
				display: flex;
				flex: 1;
				overflow: hidden;
			}

			/* Sidebar Navigation */
			.sidebar {
				width: 240px;
				background: var(--bg-elevated);
				border-right: 1px solid var(--border);
				overflow-y: auto;
				padding: 16px 0;
			}

			.sidebar-section {
				margin-bottom: 24px;
			}

			.sidebar-label {
				font-size: 11px;
				font-weight: 600;
				color: var(--fg-muted);
				text-transform: uppercase;
				letter-spacing: 0.5px;
				padding: 0 16px 8px;
			}

			.nav-item {
				display: flex;
				align-items: center;
				gap: 12px;
				padding: 10px 16px;
				margin: 2px 8px;
				border-radius: 6px;
				cursor: pointer;
				transition: all 0.2s;
				color: var(--fg-muted);
				text-decoration: none;
				font-size: 14px;
				font-weight: 500;
			}

			.nav-item:hover {
				background: var(--card);
				color: var(--fg);
			}

			.nav-item.active {
				background: var(--primary);
				color: white;
			}

			.nav-icon {
				width: 20px;
				height: 20px;
				flex-shrink: 0;
			}

			/* Content Area */
			.content {
				flex: 1;
				display: flex;
				flex-direction: column;
				overflow: hidden;
			}

			/* KPI Cards */
			.kpi-bar {
				display: flex;
				gap: 12px;
				padding: 16px 24px;
				background: var(--bg);
				border-bottom: 1px solid var(--border);
				overflow-x: auto;
			}

			.kpi-card {
				min-width: 160px;
				background: var(--card);
				border: 1px solid var(--border);
				border-radius: 8px;
				padding: 12px 16px;
				transition: all 0.2s;
			}

			.kpi-card:hover {
				border-color: var(--border-light);
				transform: translateY(-2px);
				box-shadow: 0 4px 12px var(--shadow);
			}

			.kpi-label {
				font-size: 12px;
				color: var(--fg-muted);
				margin-bottom: 4px;
			}

			.kpi-value {
				font-size: 24px;
				font-weight: 700;
				color: var(--fg);
			}

			.kpi-trend {
				font-size: 11px;
				margin-top: 4px;
				display: flex;
				align-items: center;
				gap: 4px;
			}

			.kpi-trend.positive {
				color: var(--success);
			}

			.kpi-trend.negative {
				color: var(--danger);
			}

			/* Iframe Container */
			.iframe-wrapper {
				flex: 1;
				padding: 16px 24px 24px;
				overflow: hidden;
				display: flex;
				flex-direction: column;
			}

			.iframe-container {
				flex: 1;
				background: white;
				border-radius: 10px;
				overflow: hidden;
				box-shadow: 0 4px 20px var(--shadow);
				position: relative;
			}

			.iframe-container iframe {
				width: 100%;
				height: 100%;
				border: 0;
				display: block;
			}

			/* Loading State */
			.loading-overlay {
				position: absolute;
				inset: 0;
				background: rgba(15, 23, 42, 0.9);
				display: flex;
				align-items: center;
				justify-content: center;
				opacity: 0;
				pointer-events: none;
				transition: opacity 0.3s;
			}

			.loading-overlay.active {
				opacity: 1;
				pointer-events: all;
			}

			.spinner {
				width: 40px;
				height: 40px;
				border: 3px solid var(--border);
				border-top-color: var(--primary);
				border-radius: 50%;
				animation: spin 0.8s linear infinite;
			}

			@keyframes spin {
				to {
					transform: rotate(360deg);
				}
			}

			@keyframes pulse {
				0%, 100% {
					opacity: 1;
				}
				50% {
					opacity: 0.7;
				}
			}

			.kpi-card.warning-card {
				border-color: var(--warning);
				animation: pulse 2s ease-in-out infinite;
			}

			.kpi-card.warning-card .kpi-label {
				color: var(--warning);
			}

			/* Modal Popup */
			.modal-backdrop {
				position: fixed;
				inset: 0;
				background: rgba(0, 0, 0, 0.6);
				backdrop-filter: blur(8px);
				-webkit-backdrop-filter: blur(8px);
				display: none;
				align-items: center;
				justify-content: center;
				z-index: 2000;
				opacity: 0;
				transition: opacity 0.3s;
			}

			.modal-backdrop.active {
				display: flex;
				opacity: 1;
			}

			.modal-content {
				background: var(--card);
				border: 1px solid var(--border);
				border-radius: 16px;
				padding: 32px;
				max-width: 500px;
				width: 90%;
				box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
				text-align: center;
				transform: scale(0.9);
				transition: transform 0.3s;
				position: relative;
			}

			.modal-backdrop.active .modal-content {
				transform: scale(1);
			}

			.modal-icon {
				width: 120px;
				height: auto;
				margin: 0 auto 20px;
				border-radius: 12px;
				object-fit: contain;
			}

			.modal-strip {
				width: 100%;
				height: auto;
				margin-top: 20px;
				border-radius: 8px;
				border: 1px solid var(--border);
			}

			.modal-title {
				font-size: 22px;
				font-weight: 700;
				color: var(--fg);
				margin-bottom: 12px;
			}

			.modal-text {
				font-size: 15px;
				color: var(--fg-muted);
				line-height: 1.6;
				margin-bottom: 24px;
			}

			.modal-close {
				position: absolute;
				top: 16px;
				right: 16px;
				background: transparent;
				border: none;
				color: var(--fg-muted);
				cursor: pointer;
				padding: 8px;
				border-radius: 6px;
				transition: all 0.2s;
			}

			.modal-close:hover {
				background: var(--bg-elevated);
				color: var(--fg);
			}

			/* Responsive */
			@media (max-width: 768px) {
				.sidebar {
					position: fixed;
					left: -240px;
					top: 64px;
					height: calc(100% - 64px);
					z-index: 99;
					transition: left 0.3s;
				}

				.sidebar.open {
					left: 0;
				}

				.kpi-bar {
					padding: 12px 16px;
				}

				.iframe-wrapper {
					padding: 12px 16px 16px;
				}

				.nav-title {
					font-size: 16px;
				}

				.nav-subtitle {
					display: none;
				}
			}
		</style>
	</head>
	<body>
		<!-- Top Navigation -->
		<nav class="top-nav">
			<div class="nav-brand">
				<img src="logo.png" alt="Hospital Logo" class="nav-logo" onerror="this.style.display='none'" />
				<div>
					<div class="nav-title">Hospital Patient Flow</div>
					<div class="nav-subtitle">Analytics Dashboard</div>
				</div>
			</div>

			<div class="nav-actions">
				<button class="btn-icon" id="themeToggle" title="Toggle Theme" onclick="toggleTheme()">
					<svg class="nav-icon moon-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
					</svg>
					<svg class="nav-icon sun-icon" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
					</svg>
				</button>
				<button class="btn-icon" title="Refresh Data" onclick="refreshDashboard()">
					<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
					</svg>
				</button>
				<button class="btn-icon" title="Toggle Fullscreen" onclick="toggleFullscreen()">
					<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
					</svg>
				</button>
				<button class="btn btn-secondary" onclick="exportData()">
					<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
					</svg>
					Download
				</button>
			</div>
		</nav>

		<!-- Main Layout -->
		<div class="main-layout">
			<!-- Sidebar -->
			<aside class="sidebar">
				<div class="sidebar-section">
					<div class="sidebar-label">Dashboards</div>
					<a href="#Overview" class="nav-item active" onclick="navigateSheet(event, 0, 'Overview')">
						<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
						</svg>
						Overview
					</a>
					<a href="#Gender%20Analysis" class="nav-item" onclick="navigateSheet(event, 1, 'Gender Analysis')">
						<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
						</svg>
						Gender Analysis
					</a>
					<a href="#Age%20Analysis" class="nav-item" onclick="navigateSheet(event, 2, 'Age Analysis')">
						<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
						</svg>
						Age Analysis
					</a>
					<a href="#Neighbourhood%20Analysis" class="nav-item" onclick="navigateSheet(event, 3, 'Neighbourhood Analysis')">
						<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
						</svg>
						Neighbourhood
					</a>
					<a href="#Appointment%20Analysis" class="nav-item" onclick="navigateSheet(event, 5, 'Appointment Analysis')">
						<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
						</svg>
						Appointments
					</a>
					<a href="#Final%20Dashboard" class="nav-item" onclick="navigateSheet(event, 6, 'Final Dashboard')">
						<svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" />
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
						</svg>
						Final Dashboard
					</a>
				</div>
			</aside>

			<!-- Content Area -->
			<main class="content">
				<!-- KPI Bar -->
				<div class="kpi-bar">
					<div class="kpi-card">
						<div class="kpi-label">Total Patients</div>
						<div class="kpi-value">493</div>
						<div class="kpi-trend positive">
							<span>↑ 12%</span>
						</div>
					</div>
					<div class="kpi-card">
						<div class="kpi-label">No-Shows</div>
						<div class="kpi-value">83</div>
						<div class="kpi-trend negative">
							<span>↓ 17%</span>
						</div>
					</div>
					<div class="kpi-card">
						<div class="kpi-label">Shows</div>
						<div class="kpi-value">410</div>
						<div class="kpi-trend positive">
							<span>↑ 83%</span>
						</div>
					</div>
					<div class="kpi-card">
						<div class="kpi-label">Avg Wait (Days)</div>
						<div class="kpi-value">11</div>
						<div class="kpi-trend">
							<span>—</span>
						</div>
					</div>
				<div class="kpi-card">
					<div class="kpi-label">Avg Stay (Days)</div>
					<div class="kpi-value">9</div>
					<div class="kpi-trend">
						<span>—</span>
					</div>
				</div>
				<div class="kpi-card warning-card">
					<div class="kpi-label">⏳ Loading Notice</div>
					<div class="kpi-value" style="font-size: 14px; font-weight: 500; line-height: 1.4; margin-top: 4px;">Excel sheets may take a few moments to load. Please wait...</div>
				</div>
			</div>				<!-- Excel Embed -->
				<div class="iframe-wrapper">
					<div class="iframe-container">
						<div class="loading-overlay" id="loadingOverlay">
							<div class="spinner"></div>
						</div>
						<iframe
							id="dashboardFrame"
							frameborder="0"
							scrolling="no"
							src="https://1drv.ms/x/c/45f7ffe3582fb48b/IQTbla46cdsIR7qvUf7calGrAaFeGnrUYZ6LbkP5Y_MZLxk?em=2&AllowTyping=True&ActiveCell='Overview'!A1&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True"
						></iframe>
					</div>
				</div>
			</main>
		</div>

		<!-- Download Instructions Modal -->
		<div class="modal-backdrop" id="downloadModal">
			<div class="modal-content" style="position: relative;">
				<button class="modal-close" onclick="closeDownloadModal()">
					<svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
					</svg>
				</button>
				<img src="download-button.png" alt="Download Button" class="modal-icon" onerror="this.style.display='none'" />
				<div class="modal-title">Download Excel File</div>
				<div class="modal-text">
					To download the Excel file, please click the <strong>Download button</strong> located at the <strong>bottom of the Excel viewer</strong>.
					<br><br>
					<span style="color: var(--primary); font-weight: 600;">Look for the download icon in the Excel toolbar below ⬇️</span>
					<img src="excel-toolbar.png" alt="Excel Toolbar" class="modal-strip" onerror="this.style.display='none'" />
				</div>
				
			</div>
		</div>

		<script>
		// Sheet embed URLs mapping
		const SHEET_URLS = {
			'Overview': 'https://1drv.ms/x/c/45f7ffe3582fb48b/IQTbla46cdsIR7qvUf7calGrAaFeGnrUYZ6LbkP5Y_MZLxk?em=2&AllowTyping=True&ActiveCell=\'Overview\'!A1&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True',
			'Gender Analysis': 'https://1drv.ms/x/c/45f7ffe3582fb48b/IQT6T0EX9DP4TJXS103bwiu1Ac1yStEnzz-BaZUHYBBs8ig?em=2&wdAllowInteractivity=False&ActiveCell=\'Gender%20Analysis\'!C7&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True',
				'Age Analysis': 'https://1drv.ms/x/c/45f7ffe3582fb48b/IQRIpPCT7IrzQocYmORb0cakAWezcnROjidmtQ_hlarCZYg?em=2&AllowTyping=True&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True',
				'Neighbourhood Analysis': 'https://1drv.ms/x/c/45f7ffe3582fb48b/IQSucHyyGBjORZLbHh1gmPzeAVc_KRUQHn_rid2xnEaoZw8?em=2&AllowTyping=True&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True',
				'Appointment Analysis': 'https://1drv.ms/x/c/45f7ffe3582fb48b/IQQsjpHtm-dsR5BvSbjjZ9C7AdMNgCtk_Lj7RTMfCYSJI-E?em=2&AllowTyping=True&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True',
				'Final Dashboard': 'https://1drv.ms/x/c/45f7ffe3582fb48b/IQSyAgg_6dcUTJXgCka6ny9zAWwQot6ebfyV2QwMTo0H1RY?em=2&AllowTyping=True&wdHideGridlines=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True&wdInConfigurator=True'
			};

			// Navigate to specific sheet using separate embed URLs
			function navigateSheet(event, sheetIndex, sheetName) {
				event.preventDefault();
				
				// Update active nav item
				document.querySelectorAll('.nav-item').forEach(item => {
					item.classList.remove('active');
				});
				event.currentTarget.classList.add('active');

				// Show loading overlay
				const overlay = document.getElementById('loadingOverlay');
				overlay.classList.add('active');

				// Switch to the appropriate sheet URL
				const iframe = document.getElementById('dashboardFrame');
				const targetUrl = SHEET_URLS[sheetName];
				
				if (targetUrl) {
					iframe.src = targetUrl;
					
					// Hide overlay after iframe loads
					setTimeout(() => {
						overlay.classList.remove('active');
					}, 2000);
				} else {
					console.error('No URL found for sheet:', sheetName);
					overlay.classList.remove('active');
				}
			}

			// Toggle light/dark theme
			function toggleTheme() {
				const root = document.documentElement;
				const isLight = root.classList.contains('light-mode');
				const moonIcon = document.querySelector('.moon-icon');
				const sunIcon = document.querySelector('.sun-icon');
				
				if (isLight) {
					root.classList.remove('light-mode');
					localStorage.setItem('theme', 'dark');
					moonIcon.style.display = 'block';
					sunIcon.style.display = 'none';
				} else {
					root.classList.add('light-mode');
					localStorage.setItem('theme', 'light');
					moonIcon.style.display = 'none';
					sunIcon.style.display = 'block';
				}
			}

			// Load saved theme on page load
			const savedTheme = localStorage.getItem('theme');
			if (savedTheme === 'light') {
				document.documentElement.classList.add('light-mode');
				document.querySelector('.moon-icon').style.display = 'none';
				document.querySelector('.sun-icon').style.display = 'block';
			}

			// Refresh dashboard
			function refreshDashboard() {
				const overlay = document.getElementById('loadingOverlay');
				overlay.classList.add('active');
				
				const iframe = document.getElementById('dashboardFrame');
				iframe.src = iframe.src;

				setTimeout(() => {
					overlay.classList.remove('active');
				}, 2000);
			}

			// Toggle fullscreen
			function toggleFullscreen() {
				const container = document.querySelector('.iframe-container');
				if (!document.fullscreenElement) {
					container.requestFullscreen();
				} else {
					document.exitFullscreen();
				}
			}

			// Show download instructions modal
			function exportData() {
				const modal = document.getElementById('downloadModal');
				modal.classList.add('active');
				
				// Auto-close after 5 seconds
				setTimeout(() => {
					closeDownloadModal();
				}, 5000);
			}
			
			// Close download modal
			function closeDownloadModal() {
				const modal = document.getElementById('downloadModal');
				modal.classList.remove('active');
			}
			
			// Close modal when clicking backdrop
			document.getElementById('downloadModal').addEventListener('click', function(e) {
				if (e.target === this) {
					closeDownloadModal();
				}
			});
			
			// Helper function to show toast notifications
			function showToast(message, type = 'info') {
				const toast = document.createElement('div');
				const bgColor = type === 'success' ? 'var(--success)' : type === 'warning' ? 'var(--warning)' : 'var(--primary)';
				
				toast.style.cssText = `position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%); background: ${bgColor}; color: white; padding: 16px 32px; border-radius: 12px; z-index: 1000; font-size: 14px; font-weight: 500; box-shadow: 0 8px 24px rgba(0,0,0,0.4); display: flex; align-items: center; gap: 12px;`;
				toast.innerHTML = `
					<svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
					</svg>
					<span>${message}</span>
				`;
				document.body.appendChild(toast);

				setTimeout(() => {
					toast.style.transition = 'opacity 0.4s, transform 0.4s';
					toast.style.opacity = '0';
					toast.style.transform = 'translateX(-50%) translateY(20px)';
					setTimeout(() => toast.remove(), 400);
				}, 3000);
			}

			// Hide loading when Excel embed loads
			const iframe = document.getElementById('dashboardFrame');
			if (iframe) {
				iframe.addEventListener('load', () => {
					document.getElementById('loadingOverlay').classList.remove('active');
				});
			}

			setTimeout(() => {
				document.getElementById('loadingOverlay').classList.remove('active');
			}, 3000);
			
			// Close modal when clicking backdrop
			setTimeout(() => {
				document.getElementById('downloadModal').addEventListener('click', function(e) {
					if (e.target === this) {
						closeDownloadModal();
					}
				});
			}, 100);
		</script>
	</body>
</html>